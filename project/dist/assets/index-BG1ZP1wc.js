import{j as e,u as ee,a as O,b as Q,Q as Ze,c as Xe,R as Ge}from"./query-vendor-CrITuC7M.js";import{a as es,r as b,R as ss,L as q,u as ts,b as ce,B as as,d as rs,e as F,N as ue}from"./react-vendor-BScxYr91.js";import{c as is}from"./supabase-vendor-R5TAoM4c.js";import{t as ns,c as ls,B as de,C as Le,L as R,F as De,a as Ee,A as P,T as ae,M as H,b as K,S as qe,X as le,d as os,P as me,e as J,f as be,g as Ne,h as Te,i as xe,j as ve,U as W,k as he,Z as Me,l as cs,m as ge,n as ds,o as pe,p as fe,q as X,r as ms,s as Re,u as oe,v as B,w as G,x as xs,y as us,z as hs,D as ne,E as gs,G as Fe,H as z,I as ps,J as Ue,K as fs,N as js,O as ys,Q as bs,R as Ns,V as Pe,W as Be,Y as vs,_ as ws,$ as we,a0 as Ce,a1 as Cs,a2 as ks,a3 as Ss}from"./ui-vendor-DQFDCJEL.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))o(g);new MutationObserver(g=>{for(const l of g)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(g){const l={};return g.integrity&&(l.integrity=g.integrity),g.referrerPolicy&&(l.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?l.credentials="include":g.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(g){if(g.ep)return;g.ep=!0;const l=a(g);fetch(g.href,l)}})();var Oe,ke=es;Oe=ke.createRoot,ke.hydrateRoot;const _s="https://jmhrsqgcafdenzcexovy.supabase.co",Is="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImptaHJzcWdjYWZkZW56Y2V4b3Z5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY4MjUyNTQsImV4cCI6MjA1MjQwMTI1NH0.bi75nD4i5eN73isEZn-qP3a1YcusfOOYysSnZufK8Xo",A=is(_s,Is),Qe=b.createContext(void 0);function As({children:s}){const[t,a]=b.useState(null),[o,g]=b.useState(!0);b.useEffect(()=>{A.auth.getSession().then(({data:{session:n}})=>{a((n==null?void 0:n.user)??null),g(!1)});const{data:{subscription:m}}=A.auth.onAuthStateChange((n,c)=>{a((c==null?void 0:c.user)??null)});return()=>m.unsubscribe()},[]);const l=async(m,n)=>{const{error:c}=await A.auth.signInWithPassword({email:m,password:n});if(c)throw c},d=async(m,n)=>{const{error:c}=await A.auth.signUp({email:m,password:n});if(c)throw c},y=async()=>{const{error:m}=await A.auth.signOut();if(m)throw m};return e.jsx(Qe.Provider,{value:{user:t,loading:o,signIn:l,signUp:d,signOut:y},children:s})}function M(){const s=b.useContext(Qe);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}function Ve(s){return ee({queryKey:["profile",s],queryFn:async()=>{const{data:t,error:a}=await A.from("profiles").select("*").eq("id",s).single();if(a){if(a.code==="PGRST116"){const{data:o,error:g}=await A.from("profiles").insert({id:s}).select().single();if(g)throw g;return o}throw a}return t},enabled:!!s})}function je(){return ee({queryKey:["users"],queryFn:async()=>{const{data:s,error:t}=await A.from("profiles").select(`
          *,
          ideas:ideas!ideas_author_id_fkey(count),
          comments:comments(count)
        `);if(t)throw t;return s}})}function Ke(){const s=O();return Q({mutationFn:async({id:t,...a})=>{const{data:o,error:g}=await A.from("profiles").update(a).eq("id",t).select().single();if(g)throw g;return o},onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["users"]}),s.invalidateQueries({queryKey:["profile",a.id]})}})}function Ls(){const{user:s}=M();return ee({queryKey:["notifications",s==null?void 0:s.id],queryFn:async()=>{if(!s)return[];const{data:t,error:a}=await A.from("notifications").select(`
          *,
          actor:profiles!actor_id(*),
          idea:ideas(*)
        `).eq("user_id",s.id).order("created_at",{ascending:!1});if(a)throw a;return t},enabled:!!s})}function Ds(){const s=O();return Q({mutationFn:async t=>{const{data:a,error:o}=await A.from("notifications").update({read:!0}).eq("id",t).select().single();if(o)throw o;return a},onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["notifications"]})}})}function Es(){const s=O(),{user:t}=M();return Q({mutationFn:async()=>{if(!t)return;const{data:a,error:o}=await A.from("notifications").update({read:!0}).eq("user_id",t.id).select();if(o)throw o;return a},onSuccess:()=>{s.invalidateQueries({queryKey:["notifications"]})}})}function _(...s){return ns(ls(s))}function Se(){const{data:s,isLoading:t}=Ls(),{mutate:a}=Ds(),{mutate:o}=Es(),[g,l]=ss.useState(!1),d=b.useRef(null),y=(s==null?void 0:s.filter(c=>!c.read).length)||0;b.useEffect(()=>{function c(u){d.current&&!d.current.contains(u.target)&&l(!1)}return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]);const m=c=>{switch(c){case"comment":return e.jsx(H,{className:"h-4 w-4 text-blue-500"});case"vote":return e.jsx(ae,{className:"h-4 w-4 text-green-500"});case"beans":return e.jsx(P,{className:"h-4 w-4 text-yellow-500"});case"approved":return e.jsx(Ee,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(De,{className:"h-4 w-4 text-red-500"});default:return e.jsx(de,{className:"h-4 w-4 text-gray-500"})}},n=c=>{a(c),l(!1)};return e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{onClick:()=>l(!g),className:"relative p-2 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 rounded-full hover:bg-gray-100 transition-colors",children:[e.jsx(de,{className:"h-6 w-6"}),y>0&&e.jsx("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white animate-pulse",children:y})]}),g&&e.jsx("div",{className:"absolute right-0 mt-2 w-80 rounded-lg bg-white shadow-xl ring-1 ring-black ring-opacity-5 z-50 transform transition-all duration-200 origin-top-right",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Notifications"}),y>0&&e.jsxs("button",{onClick:()=>o(),className:"text-sm text-indigo-600 hover:text-indigo-500 flex items-center hover:bg-indigo-50 px-2 py-1 rounded-md transition-colors",children:[e.jsx(Le,{className:"h-4 w-4 mr-1"}),"Mark all as read"]})]}),t?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(R,{className:"h-6 w-6 animate-spin text-indigo-600"})}):s!=null&&s.length?e.jsx("div",{className:"space-y-2 max-h-[calc(100vh-200px)] overflow-y-auto custom-scrollbar",children:s.map(c=>{var u;return e.jsx(q,{to:"/my-ideas",onClick:()=>n(c.id),className:_("block p-3 rounded-lg transition-all duration-200 hover:transform hover:scale-[1.02]",c.read?"bg-white hover:bg-gray-50":"bg-indigo-50 hover:bg-indigo-100","border border-gray-100 hover:shadow-md"),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:m(c.type)}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("span",{className:"font-medium",children:((u=c.actor)==null?void 0:u.full_name)||"Someone"})," ",c.content]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:new Date(c.created_at).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),!c.read&&e.jsx("div",{className:"ml-2 flex-shrink-0",children:e.jsx("div",{className:"h-2 w-2 rounded-full bg-indigo-600"})})]})},c.id)})}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(de,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"No notifications yet"})]})]})})]})}function qs({showAdminLink:s=!1}){var N;const t=ts(),a=ce(),[o,g]=b.useState(!1),[l,d]=b.useState(!1),[y,m]=b.useState(!1),{user:n,signOut:c}=M(),{data:u}=Ve((n==null?void 0:n.id)||""),w=(N=n==null?void 0:n.email)==null?void 0:N.endsWith("@kipi.ai"),C=[{name:"Home",href:"/",emoji:"ðŸ "},{name:"FAQ",href:"/faq",emoji:"â“"},{name:"Contact",href:"/contact",emoji:"ðŸ“§"}],r=[{name:"Leaderboard",href:"/leaderboard",emoji:"ðŸ†"},{name:"Browse Ideas",href:"/browse",emoji:"ðŸ”"},{name:"My Ideas",href:"/my-ideas",emoji:"ðŸ’¡"}],x=[...C,...n?r:[],...s?[{name:"Admin",href:"/admin",emoji:"ðŸ›¡ï¸"}]:[]];b.useEffect(()=>{const f=()=>{m(window.scrollY>10)};return window.addEventListener("scroll",f),()=>window.removeEventListener("scroll",f)},[]),b.useEffect(()=>{g(!1)},[t.pathname]);const h=async()=>{try{await c(),a("/")}catch(f){console.error("Error signing out:",f)}};return e.jsx("header",{className:_("sticky top-0 z-50 transition-all duration-300",y?"bg-white/80 backdrop-blur-md shadow-md":"bg-white shadow-sm"),children:e.jsxs("nav",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Top",children:[e.jsxs("div",{className:"flex h-16 items-center justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs(q,{to:"/",className:"flex items-center group transition-transform duration-300 hover:scale-105",onClick:()=>g(!1),children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"h-8 w-8 text-indigo-600 transition-all duration-500 group-hover:text-yellow-500"}),e.jsx(qe,{className:"absolute -top-1 -right-1 h-4 w-4 text-yellow-400 opacity-0 group-hover:opacity-100 transition-all duration-300"})]}),e.jsxs("div",{className:"ml-2 flex flex-col",children:[e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-indigo-600 to-blue-500 bg-clip-text text-transparent",children:"Kipi"}),e.jsx("span",{className:"text-sm font-medium text-gray-600 -mt-1",children:"Innovate"})]})]})}),e.jsxs("div",{className:"flex items-center md:hidden",children:[n&&e.jsx(Se,{}),e.jsxs("button",{type:"button",onClick:()=>g(!o),className:"ml-2 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500",children:[e.jsx("span",{className:"sr-only",children:"Open main menu"}),o?e.jsx(le,{className:"block h-6 w-6"}):e.jsx(os,{className:"block h-6 w-6"})]})]}),e.jsxs("div",{className:"hidden md:flex md:items-center md:space-x-6",children:[x.map(f=>e.jsxs(q,{to:f.href,className:_("relative text-sm font-medium transition-all duration-300 hover:scale-105 flex items-center space-x-1 py-2",t.pathname===f.href?"text-indigo-600 after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-indigo-600 after:transform after:scale-x-100 after:transition-transform":"text-gray-500 hover:text-gray-900 after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-indigo-600 after:transform after:scale-x-0 hover:after:scale-x-100 after:transition-transform"),children:[e.jsx("span",{children:f.emoji}),e.jsx("span",{children:f.name})]},f.name)),n&&!w&&e.jsxs(q,{to:"/submit",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-all duration-300 hover:scale-105 hover:shadow-lg",children:[e.jsx(me,{className:"h-4 w-4 mr-1"}),"Submit Idea âœ¨"]}),n&&e.jsx(Se,{}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!l),className:"inline-flex items-center text-gray-500 hover:text-gray-900 transition-all duration-300 hover:scale-105 p-1 rounded-full hover:bg-gray-100",children:u!=null&&u.avatar_url?e.jsx("img",{src:u.avatar_url,alt:"Profile",className:"h-8 w-8 rounded-full object-cover"}):e.jsx(J,{className:"h-8 w-8"})}),l&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-lg shadow-lg bg-white ring-1 ring-black ring-opacity-5 py-1 focus:outline-none transform transition-all duration-200 origin-top-right",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-100",children:e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n.email})}),e.jsx(q,{to:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>d(!1),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Profile Settings"]})}),e.jsx("button",{onClick:()=>{d(!1),h()},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Sign Out"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{to:"/login",className:"block px-4 py-2 text-sm text-indigo-600 hover:bg-gray-50 transition-colors",onClick:()=>d(!1),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Sign In"]})}),e.jsx(q,{to:"/register",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>d(!1),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Account"]})})]})})]})]})]}),e.jsx("div",{className:_("absolute left-0 right-0 top-16 z-50 transform transition-all duration-300 ease-in-out md:hidden",o?"translate-y-0 opacity-100":"-translate-y-2 opacity-0 pointer-events-none","bg-white border-b border-gray-200 shadow-lg"),children:e.jsxs("div",{className:"max-h-[calc(100vh-4rem)] overflow-y-auto",children:[n&&e.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:u!=null&&u.avatar_url?e.jsx("img",{src:u.avatar_url,alt:"Profile",className:"h-10 w-10 rounded-full object-cover"}):e.jsx(J,{className:"h-10 w-10 text-gray-400"})}),e.jsx("div",{className:"ml-3",children:e.jsx("div",{className:"text-base font-medium text-gray-800 truncate",children:n.email})})]})}),e.jsx("div",{className:"px-4 py-3",children:e.jsx("div",{className:"grid gap-2",children:x.map(f=>e.jsxs(q,{to:f.href,className:_("flex items-center px-3 py-2 rounded-md text-base font-medium transition-colors duration-300",t.pathname===f.href?"bg-indigo-50 text-indigo-600":"text-gray-500 hover:bg-gray-50 hover:text-gray-900"),onClick:()=>g(!1),children:[e.jsx("span",{className:"mr-3",children:f.emoji}),e.jsx("span",{children:f.name})]},f.name))})}),e.jsx("div",{className:"px-4 py-3 border-t border-gray-200",children:n?e.jsxs("div",{className:"space-y-2",children:[!w&&e.jsxs(q,{to:"/submit",className:"flex items-center justify-center w-full px-3 py-2 rounded-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:()=>g(!1),children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Submit Idea âœ¨"]}),e.jsxs(q,{to:"/profile",className:"flex items-center w-full px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>g(!1),children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Profile Settings"]}),e.jsxs("button",{onClick:()=>{g(!1),h()},className:"flex items-center w-full px-3 py-2 rounded-md text-sm font-medium text-red-600 hover:bg-gray-50 transition-colors",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs(q,{to:"/login",className:"flex items-center justify-center w-full px-3 py-2 rounded-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 transition-colors",onClick:()=>g(!1),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Sign In"]}),e.jsxs(q,{to:"/register",className:"flex items-center justify-center w-full px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>g(!1),children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Account"]})]})})]})})]})})}function Ts(){return e.jsx("footer",{className:"bg-white",children:e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"py-12 md:flex md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex justify-center space-x-6 md:order-2",children:[e.jsx(q,{to:"/faq",className:"text-gray-400 hover:text-gray-500",children:"FAQ"}),e.jsx(q,{to:"/contact",className:"text-gray-400 hover:text-gray-500",children:"Contact"})]}),e.jsx("div",{className:"mt-8 md:mt-0 md:order-1",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(K,{className:"h-6 w-6 text-indigo-600"}),e.jsxs("p",{className:"ml-2 text-center text-base text-gray-400",children:["Â© ",new Date().getFullYear()," Kipi Innovate. All rights reserved."]})]})})]})})})}const Ms=1e3*60*5,Rs=1e3*60*30;function se(s){return ee({queryKey:["ideas"],queryFn:async()=>{const{data:t,error:a}=await A.from("ideas").select(`
          *,
          author:profiles!ideas_author_id_fkey(*),
          feedback_by:profiles!ideas_feedback_by_fkey(*),
          comments:comments(*),
          votes:votes(*),
          contributors:idea_contributors(
            user_id,
            profiles:profiles(*)
          )
        `).order("created_at",{ascending:!1});if(a)throw a;return t},staleTime:Ms,cacheTime:Rs,...s})}function We(){const s=O();return Q({mutationFn:async t=>{const{data:a,error:o}=await A.from("ideas").insert(t).select().single();if(o)throw o;return a},onSuccess:()=>{s.invalidateQueries({queryKey:["ideas"]})}})}function Fs(){const s=O();return Q({mutationFn:async({id:t,updates:a,editorId:o})=>{const{data:g,error:l}=await A.from("ideas").select().eq("id",t).single();if(l)throw l;const{data:d,error:y}=await A.from("ideas").update(a).eq("id",t).select().single();if(y)throw y;const{error:m}=await A.from("idea_edit_logs").insert({idea_id:t,editor_id:o,changes:{before:g,after:d}});if(m)throw m;return d},onSuccess:t=>{s.invalidateQueries({queryKey:["ideas"]}),s.invalidateQueries({queryKey:["idea",t.id]}),s.invalidateQueries({queryKey:["idea-edit-logs",t.id]})}})}const Us=[{icon:W,title:"Collaborative Innovation",description:"Connect with colleagues, share ideas, and build on each other's insights to create breakthrough solutions."},{icon:he,title:"Impact Tracking",description:"Monitor the implementation and impact of your ideas through our comprehensive tracking system."},{icon:Te,title:"Recognition & Rewards",description:"Earn beans for your contributions and redeem them for exciting rewards and opportunities."},{icon:Me,title:"Quick Implementation",description:"See your ideas come to life with our streamlined approval and implementation process."}],Ps=[{icon:cs,title:"Idea Submission",description:"Submit your innovative ideas through our platform",eta:"Immediate acknowledgment",outcome:"Ideas enter evaluation pipeline"},{icon:ge,title:"Evaluation",description:"Ideas are assessed for feasibility and alignment with goals",eta:"7 working days",outcome:"Clear decision and next steps"},{icon:Me,title:"Implementation",description:"Approved ideas move to execution phase",eta:"Based on scope",outcome:"Successfully implemented ideas"},{icon:ds,title:"Jury Review",description:"Selected ideas presented for final review",eta:"2 weeks",outcome:"Top ideas selected for recognition"},{icon:pe,title:"Recognition",description:"Winners announced and celebrated",eta:"Next monthly Townhall",outcome:"Awards and recognition"}];function Bs(){var y;const{data:s}=se(),{user:t}=M(),a=(y=t==null?void 0:t.email)==null?void 0:y.endsWith("@kipi.ai"),o=(s==null?void 0:s.filter(m=>m.author_id===(t==null?void 0:t.id)))||[],g={total:o.length,approved:o.filter(m=>m.status==="approved").length,rejected:o.filter(m=>m.status==="rejected").length,pending:o.filter(m=>m.status==="pending").length,totalBeans:o.reduce((m,n)=>m+(n.beans_earned||0),0),totalVotes:o.reduce((m,n)=>{var c;return m+(((c=n.votes)==null?void 0:c.length)||0)},0),totalComments:o.reduce((m,n)=>{var c;return m+(((c=n.comments)==null?void 0:c.length)||0)},0),categoryDistribution:o.reduce((m,n)=>(m[n.category]=(m[n.category]||0)+1,m),{}),monthlySubmissions:o.reduce((m,n)=>{const c=new Date(n.created_at).toLocaleString("default",{month:"long"});return m[c]=(m[c]||0)+1,m},{})},l=[{name:"Total Ideas",value:g.total,icon:ge,color:"from-blue-500 to-blue-600",subtext:"ideas submitted by you"},{name:"Ideas Approved",value:g.approved,icon:fe,color:"from-green-500 to-green-600",subtext:"of your ideas approved"},{name:"Ideas Rejected",value:g.rejected,icon:X,color:"from-red-500 to-red-600",subtext:"of your ideas rejected"},{name:"Ideas Pending",value:g.pending,icon:ms,color:"from-yellow-500 to-yellow-600",subtext:"of your ideas pending"}],d=[{name:"Total Beans",value:g.totalBeans,icon:Te,color:"from-yellow-500 to-yellow-600",subtext:"beans earned from ideas"},{name:"Total Votes",value:g.totalVotes,icon:ae,color:"from-indigo-500 to-indigo-600",subtext:"votes on your ideas"},{name:"Total Comments",value:g.totalComments,icon:H,color:"from-purple-500 to-purple-600",subtext:"comments on your ideas"},{name:"Avg. Beans per Idea",value:g.total?(g.totalBeans/g.total).toFixed(1):"0",icon:xe,color:"from-emerald-500 to-emerald-600",subtext:"average beans per idea"}];return e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-16 animate-float",children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6 gradient-text",children:"Transform Ideas into Impact"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto mb-8",children:t?a?"Welcome back! Monitor and manage innovation across the organization âœ¨":"Welcome back! Track your ideas and their impact âœ¨":"Join our community of innovators and shape the future together âœ¨"}),!a&&e.jsxs(q,{to:"/submit",className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 transition-all duration-300 hover:scale-105",children:["Share Your Idea",e.jsx(ve,{className:"ml-2 h-5 w-5"})]})]}),t&&!a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:l.map((m,n)=>{const c=m.icon;return e.jsx("div",{className:"glass-effect gradient-border rounded-2xl p-6 card-hover transform transition-all duration-300",style:{animationDelay:`${n*.1}s`},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-r ${m.color} bg-opacity-10`,children:e.jsx(c,{className:"h-8 w-8 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:m.name}),e.jsx("dd",{className:"text-3xl font-bold gradient-text",children:m.value}),e.jsx("dd",{className:"text-sm text-gray-500 mt-1",children:m.subtext})]})})]})},m.name)})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16",children:d.map((m,n)=>{const c=m.icon;return e.jsx("div",{className:"glass-effect gradient-border rounded-2xl p-6 card-hover transform transition-all duration-300",style:{animationDelay:`${n*.1}s`},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-r ${m.color} bg-opacity-10`,children:e.jsx(c,{className:"h-8 w-8 text-white"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:m.name}),e.jsx("dd",{className:"text-3xl font-bold gradient-text",children:m.value}),e.jsx("dd",{className:"text-sm text-gray-500 mt-1",children:m.subtext})]})})]})},m.name)})})]}),e.jsxs("div",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12 gradient-text",children:"Our Evaluation Process"}),e.jsx("div",{className:"grid md:grid-cols-3 lg:grid-cols-5 gap-8",children:Ps.map((m,n)=>{const c=m.icon;return e.jsxs("div",{className:"glass-effect rounded-2xl p-6 text-center transform transition-all duration-300 hover:scale-105",style:{animationDelay:`${n*.15}s`},children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-xl bg-indigo-100 text-indigo-600 mb-4",children:e.jsx(c,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:m.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:m.description}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:"text-indigo-600 font-medium",children:["ETA: ",m.eta]}),e.jsxs("p",{className:"text-gray-500",children:["Outcome: ",m.outcome]})]})]},m.title)})})]}),e.jsxs("div",{className:"mb-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-12 gradient-text",children:"Why Use Kipi Innovate?"}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:Us.map((m,n)=>{const c=m.icon;return e.jsxs("div",{className:"glass-effect rounded-2xl p-6 text-center transform transition-all duration-300 hover:scale-105",style:{animationDelay:`${n*.15}s`},children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-xl bg-indigo-100 text-indigo-600 mb-4",children:e.jsx(c,{className:"h-6 w-6"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:m.title}),e.jsx("p",{className:"text-gray-600",children:m.description})]},m.title)})})]}),!t&&e.jsx("div",{className:"glass-effect gradient-border rounded-2xl p-8 text-center",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(qe,{className:"h-12 w-12 text-indigo-600 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-bold mb-4 gradient-text",children:"Ready to Make a Difference?"}),e.jsx("p",{className:"text-lg text-gray-600 leading-relaxed mb-8",children:"Your ideas matter! Join our innovative community and help shape the future of our organization. Start sharing your ideas today and earn recognition for your contributions. ðŸš€ Let's innovate together!"}),e.jsxs(q,{to:"/submit",className:"inline-flex items-center px-8 py-4 border border-transparent text-lg font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 transition-all duration-300 hover:scale-105",children:["Submit Your First Idea",e.jsx(ve,{className:"ml-2 h-5 w-5"})]})]})})]})})}function Os(){const s=O();return Q({mutationFn:async t=>{const{data:a}=await A.from("votes").select().eq("idea_id",t.idea_id).eq("user_id",t.user_id).maybeSingle();if(a)return a;const{data:o,error:g}=await A.from("votes").insert(t).select().single();if(g)throw g;return o},onSuccess:()=>{s.invalidateQueries({queryKey:["ideas"]})}})}function Qs(){const s=O();return Q({mutationFn:async({ideaId:t,userId:a})=>{const{error:o}=await A.from("votes").delete().eq("idea_id",t).eq("user_id",a);if(o)throw o},onSuccess:()=>{s.invalidateQueries({queryKey:["ideas"]})}})}function ze(s){return ee({queryKey:["comments",s],queryFn:async()=>{if(!s)return[];const{data:t,error:a}=await A.from("comments").select(`
          *,
          author:profiles(*)
        `).eq("idea_id",s).order("created_at",{ascending:!0});if(a)throw a;return t},enabled:!!s})}function He(){const s=O();return Q({mutationFn:async t=>{const{data:a,error:o}=await A.from("comments").insert(t).select().single();if(o)throw o;return a},onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["comments",a.idea_id]})}})}const Vs=["All","Lammas - Accelerator & Native Apps","Technology COE - Reusable Assets/Enablers","Delivery - Process Improvement","Industry Solutions - Domain Expertise & Business Use Cases","Data Science","Learning & Development","Sales & Marketing","Operations, HR, CSM, ESM, etc."],Ks=["All","pending","approved","rejected"],re=s=>({"Lammas - Accelerator & Native Apps":{bg:"bg-blue-100",text:"text-blue-800",icon:"text-blue-500"},"Technology COE - Reusable Assets/Enablers":{bg:"bg-purple-100",text:"text-purple-800",icon:"text-purple-500"},"Delivery - Process Improvement":{bg:"bg-green-100",text:"text-green-800",icon:"text-green-500"},"Industry Solutions - Domain Expertise & Business Use Cases":{bg:"bg-orange-100",text:"text-orange-800",icon:"text-orange-500"},"Data Science":{bg:"bg-indigo-100",text:"text-indigo-800",icon:"text-indigo-500"},"Learning & Development":{bg:"bg-pink-100",text:"text-pink-800",icon:"text-pink-500"},"Sales & Marketing":{bg:"bg-yellow-100",text:"text-yellow-800",icon:"text-yellow-500"},"Operations, HR, CSM, ESM, etc.":{bg:"bg-teal-100",text:"text-teal-800",icon:"text-teal-500"}})[s];function Ws(){var p,I,S,D;const{user:s}=M(),{data:t,isLoading:a}=se(),{mutate:o}=Os(),{mutate:g}=Qs(),[l,d]=b.useState("All"),[y,m]=b.useState("All"),[n,c]=b.useState(""),[u,w]=b.useState(null),[C,r]=b.useState(""),{mutate:x}=He(),{data:h,isLoading:N}=ze((u==null?void 0:u.id)||null),f=t==null?void 0:t.filter(i=>{const j=l==="All"||i.category===l,v=y==="All"||i.status===y,L=n===""||i.title.toLowerCase().includes(n.toLowerCase())||i.description.toLowerCase().includes(n.toLowerCase());return j&&v&&L}),k=i=>{var L;if(!s)return;const j=t==null?void 0:t.find(U=>U.id===i);((L=j==null?void 0:j.votes)==null?void 0:L.some(U=>U.user_id===s.id))?g({ideaId:i,userId:s.id}):o({idea_id:i,user_id:s.id})},E=i=>{i.preventDefault(),!(!s||!u||!C.trim())&&(x({idea_id:u.id,author_id:s.id,content:C.trim()}),r(""))},T=i=>{switch(i){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";case"pending":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}};return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"})}):e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"card p-6 mb-8",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search ideas...",value:n,onChange:i=>c(i.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("select",{id:"category",value:l,onChange:i=>d(i.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:Vs.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{id:"status",value:y,onChange:i=>m(i.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:Ks.map(i=>e.jsx("option",{value:i,children:i.charAt(0).toUpperCase()+i.slice(1)},i))})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900",children:[(f==null?void 0:f.length)??0," ",((f==null?void 0:f.length)??0)===1?"idea":"ideas"," found"]})}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:f==null?void 0:f.map(i=>{var L,U,V,te;const j=re(i.category),v=(L=i.votes)==null?void 0:L.some(Y=>Y.user_id===(s==null?void 0:s.id));return e.jsx("div",{className:"card cursor-pointer hover:scale-105 transition-all duration-300",onClick:()=>w(i),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:i.title}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T(i.status)}`,children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})]}),e.jsx("p",{className:"text-gray-500 text-sm mb-4 line-clamp-2",children:i.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:Y=>{Y.stopPropagation(),k(i.id)},className:_("flex items-center text-gray-500 hover:text-indigo-600 transition-colors",v&&"text-indigo-600"),disabled:!s,children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),((U=i.votes)==null?void 0:U.length)??0]}),e.jsxs("span",{className:"flex items-center text-gray-500",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),((V=i.comments)==null?void 0:V.length)??0]}),i.beans_earned>0&&e.jsxs("span",{className:"flex items-center text-yellow-600",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),i.beans_earned]})]}),e.jsxs("div",{className:_("flex items-center px-2.5 py-1 rounded-full",j.bg),children:[e.jsx(oe,{className:_("h-4 w-4 mr-1",j.icon)}),e.jsx("span",{className:_("truncate max-w-[150px]",j.text),title:i.category,children:i.category})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["By ",((te=i.author)==null?void 0:te.full_name)||"Anonymous"]}),e.jsx("span",{className:"text-gray-400",children:new Date(i.created_at).toLocaleDateString()})]})})]})},i.id)})}),u&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"glass-card max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:u.title}),e.jsxs("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${T(u.status)}`,children:u.status.charAt(0).toUpperCase()+u.status.slice(1)}),e.jsxs("span",{className:_("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",re(u.category).bg,re(u.category).text),children:[e.jsx(oe,{className:_("h-3 w-3 mr-1",re(u.category).icon)}),u.category]}),u.beans_earned>0&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),u.beans_earned," Beans"]})]}),e.jsx("p",{className:"text-gray-600",children:u.description}),((p=u.contributors)==null?void 0:p.length)>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(W,{className:"h-4 w-4 mr-2 text-gray-400"}),"Contributors"]}),e.jsx("div",{className:"space-y-2",children:u.contributors.map(i=>{var j,v;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center mr-3",children:e.jsx(B,{className:"h-4 w-4 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((j=i.profiles)==null?void 0:j.full_name)||"Unnamed User"}),e.jsx("p",{className:"text-xs text-gray-500",children:(v=i.profiles)==null?void 0:v.email})]})]},i.user_id)})})]}),((I=u.resource_links)==null?void 0:I.length)>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(G,{className:"h-4 w-4 mr-2 text-gray-400"}),"Resource Links"]}),e.jsx("div",{className:"space-y-2",children:u.resource_links.map(i=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.title}),e.jsx("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-500",children:i.url})]})]})},i.id))})]}),u.feedback&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Feedback"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-indigo-100 flex items-center justify-center mr-2",children:e.jsx(B,{className:"h-3 w-3 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:((S=u.feedback_by)==null?void 0:S.full_name)||"Anonymous Admin"}),u.feedback_at&&e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["on ",new Date(u.feedback_at).toLocaleDateString()]})]})]})}),e.jsx("p",{className:"text-gray-600",children:u.feedback})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["By ",((D=u.author)==null?void 0:D.full_name)||"Anonymous"]}),e.jsx("span",{className:"text-gray-400",children:new Date(u.created_at).toLocaleDateString()})]})}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comments"}),s?e.jsxs("form",{onSubmit:E,className:"mb-6",children:[e.jsx("textarea",{value:C,onChange:i=>r(i.target.value),placeholder:"Add a comment...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:3}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"submit",disabled:!C.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Post Comment"})})]}):e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Please sign in to comment."}),N?e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{className:"h-6 w-6 animate-spin text-indigo-600"})}):h!=null&&h.length?e.jsx("div",{className:"space-y-4",children:h.map(i=>{var j;return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((j=i.author)==null?void 0:j.full_name)||"Anonymous"}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(i.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:i.content})]},i.id)})}):e.jsx("p",{className:"text-sm text-gray-500",children:"No comments yet."})]})]})]})})})]})})}const zs=["All","Lammas - Accelerator & Native Apps","Technology COE - Reusable Assets/Enablers","Delivery - Process Improvement","Industry Solutions - Domain Expertise & Business Use Cases","Data Science","Learning & Development","Sales & Marketing","Operations, HR, CSM, ESM, etc."],Hs=["All","pending","approved","rejected"],ie=s=>({"Lammas - Accelerator & Native Apps":{bg:"bg-blue-100",text:"text-blue-800",icon:"text-blue-500"},"Technology COE - Reusable Assets/Enablers":{bg:"bg-purple-100",text:"text-purple-800",icon:"text-purple-500"},"Delivery - Process Improvement":{bg:"bg-green-100",text:"text-green-800",icon:"text-green-500"},"Industry Solutions - Domain Expertise & Business Use Cases":{bg:"bg-orange-100",text:"text-orange-800",icon:"text-orange-500"},"Data Science":{bg:"bg-indigo-100",text:"text-indigo-800",icon:"text-indigo-500"},"Learning & Development":{bg:"bg-pink-100",text:"text-pink-800",icon:"text-pink-500"},"Sales & Marketing":{bg:"bg-yellow-100",text:"text-yellow-800",icon:"text-yellow-500"},"Operations, HR, CSM, ESM, etc.":{bg:"bg-teal-100",text:"text-teal-800",icon:"text-teal-500"}})[s];function Ys(){var E,T;const{user:s}=M(),{data:t,isLoading:a}=se(),[o,g]=b.useState(null),[l,d]=b.useState(""),{mutate:y}=He(),{data:m,isLoading:n}=ze((o==null?void 0:o.id)||null),[c,u]=b.useState(""),[w,C]=b.useState("All"),[r,x]=b.useState("All"),h=t==null?void 0:t.filter(p=>p.author_id===(s==null?void 0:s.id)),N=h==null?void 0:h.filter(p=>{const I=w==="All"||p.category===w,S=r==="All"||p.status===r,D=c===""||p.title.toLowerCase().includes(c.toLowerCase())||p.description.toLowerCase().includes(c.toLowerCase());return I&&S&&D}),f=p=>{p.preventDefault(),!(!s||!o||!l.trim())&&(y({idea_id:o.id,author_id:s.id,content:l.trim()}),d(""))},k=p=>{switch(p){case"approved":return"text-green-600 bg-green-100";case"rejected":return"text-red-600 bg-red-100";case"pending":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}};return a?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"})}):e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"My Ideas"}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search ideas...",value:c,onChange:p=>u(p.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]}),e.jsx("div",{children:e.jsx("select",{value:w,onChange:p=>C(p.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:zs.map(p=>e.jsx("option",{value:p,children:p},p))})}),e.jsx("div",{children:e.jsx("select",{value:r,onChange:p=>x(p.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:Hs.map(p=>e.jsx("option",{value:p,children:p.charAt(0).toUpperCase()+p.slice(1)},p))})})]})})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title & Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Engagement"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contributors"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N==null?void 0:N.map(p=>{var S,D,i,j;const I=ie(p.category);return e.jsxs("tr",{onClick:()=>g(p),className:"hover:bg-gray-50 cursor-pointer",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.title}),e.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:p.description}),((S=p.resource_links)==null?void 0:S.length)>0&&e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),p.resource_links.length," resource",p.resource_links.length!==1?"s":""]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:_("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",I.bg,I.text),children:[e.jsx(oe,{className:_("h-3 w-3 mr-1",I.icon)}),p.category]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:_("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",k(p.status)),children:p.status.charAt(0).toUpperCase()+p.status.slice(1)}),p.feedback&&e.jsx("div",{className:"mt-1 text-xs text-gray-500",children:e.jsx("div",{className:"line-clamp-2 italic",children:p.feedback})})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),((D=p.votes)==null?void 0:D.length)||0]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),((i=p.comments)==null?void 0:i.length)||0]}),p.beans_earned>0&&e.jsxs("span",{className:"flex items-center text-yellow-600",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),p.beans_earned]})]})}),e.jsx("td",{className:"px-6 py-4",children:((j=p.contributors)==null?void 0:j.length)>0?e.jsxs("div",{className:"flex -space-x-2",children:[p.contributors.slice(0,3).map(v=>{var L;return e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center border-2 border-white",title:((L=v.profiles)==null?void 0:L.full_name)||"Unnamed User",children:e.jsx(B,{className:"h-4 w-4 text-indigo-600"})},v.user_id)}),p.contributors.length>3&&e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center border-2 border-white",children:e.jsxs("span",{className:"text-xs text-gray-600",children:["+",p.contributors.length-3]})})]}):e.jsx("span",{className:"text-sm text-gray-500",children:"No contributors"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString()})]},p.id)})})]})})}),o&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"glass-card max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o.title}),e.jsxs("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-500",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:_("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",k(o.status)),children:o.status.charAt(0).toUpperCase()+o.status.slice(1)}),e.jsxs("span",{className:_("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",ie(o.category).bg,ie(o.category).text),children:[e.jsx(oe,{className:_("h-3 w-3 mr-1",ie(o.category).icon)}),o.category]})]}),e.jsx("p",{className:"text-gray-600",children:o.description}),((E=o.contributors)==null?void 0:E.length)>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(W,{className:"h-4 w-4 mr-2 text-gray-400"}),"Contributors"]}),e.jsx("div",{className:"space-y-2",children:o.contributors.map(p=>{var I,S;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center mr-3",children:e.jsx(B,{className:"h-4 w-4 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:((I=p.profiles)==null?void 0:I.full_name)||"Unnamed User"}),e.jsx("p",{className:"text-xs text-gray-500",children:(S=p.profiles)==null?void 0:S.email})]})]},p.user_id)})})]}),((T=o.resource_links)==null?void 0:T.length)>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(G,{className:"h-4 w-4 mr-2 text-gray-400"}),"Resource Links"]}),e.jsx("div",{className:"space-y-2",children:o.resource_links.map(p=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:p.title}),e.jsx("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-500",children:p.url})]})]})},p.id))})]}),o.feedback&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Feedback"}),e.jsx("p",{className:"text-sm text-gray-600",children:o.feedback})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comments"}),e.jsxs("form",{onSubmit:f,className:"mb-6",children:[e.jsx("textarea",{value:l,onChange:p=>d(p.target.value),placeholder:"Add a comment...",className:"w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:3}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"submit",disabled:!l.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Post Comment"})})]}),n?e.jsx("div",{className:"flex justify-center",children:e.jsx(R,{className:"h-6 w-6 animate-spin text-indigo-600"})}):m!=null&&m.length?e.jsx("div",{className:"space-y-4",children:m.map(p=>{var I;return e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((I=p.author)==null?void 0:I.full_name)||"Anonymous"}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(p.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:p.content})]},p.id)})}):e.jsx("p",{className:"text-sm text-gray-500",children:"No comments yet."})]})]})]})})})]})})}const $s=["Lammas - Accelerator & Native Apps","Technology COE - Reusable Assets/Enablers","Delivery - Process Improvement","Industry Solutions - Domain Expertise & Business Use Cases","Data Science","Learning & Development","Sales & Marketing","Operations, HR, CSM, ESM, etc."];function Js(){var i;const{user:s}=M(),t=ce(),{mutate:a,isLoading:o}=We(),g=(i=s==null?void 0:s.email)==null?void 0:i.endsWith("@kipi.ai"),[l,d]=b.useState({title:"",category:"",description:"",resourceLinks:[],contributors:[]}),[y,m]=b.useState(null),[n,c]=b.useState(""),[u,w]=b.useState([]),[C,r]=b.useState(!1),[x,h]=b.useState(""),[N,f]=b.useState("");if(b.useEffect(()=>{g&&t("/")},[g,t]),g)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xs,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Administrators cannot submit ideas. Please use a regular user account."}),e.jsx("button",{onClick:()=>t("/"),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:"Return to Home"})]})});const k=async j=>{if(!j.trim()){w([]);return}r(!0);try{const{data:v,error:L}=await A.from("profiles").select("id, full_name, email").ilike("email",`%${j}%`).limit(5);if(L)throw L;w(v||[])}catch(v){console.error("Error searching contributors:",v)}finally{r(!1)}},E=j=>{const v=j.target.value;c(v),k(v)},T=j=>{l.contributors.some(v=>v.id===j.id)||d(v=>({...v,contributors:[...v.contributors,j]})),c(""),w([])},p=j=>{d(v=>({...v,contributors:v.contributors.filter(L=>L.id!==j)}))},I=()=>{if(N.trim()&&x.trim()){const j={id:crypto.randomUUID(),url:N.trim(),title:x.trim()};d(v=>({...v,resourceLinks:[...v.resourceLinks,j]})),f(""),h("")}},S=j=>{d(v=>({...v,resourceLinks:v.resourceLinks.filter(L=>L.id!==j)}))},D=async j=>{if(j.preventDefault(),!!s)try{m(null),await a({title:l.title,description:l.description,category:l.category,author_id:s.id,status:"pending",resource_links:l.resourceLinks},{onSuccess:async v=>{l.contributors.length>0&&await Promise.all(l.contributors.map(async L=>{const{error:U}=await A.from("idea_contributors").insert({idea_id:v.id,user_id:L.id});if(U)throw U})),t("/my-ideas")}})}catch(v){console.error("Error submitting idea:",v),m("Failed to submit idea. Please try again.")}};return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Submit Your Idea"}),e.jsx("p",{className:"mt-2 text-lg text-gray-600",children:"Share your innovative ideas with the community"})]}),e.jsxs("form",{onSubmit:D,className:"bg-white shadow-lg rounded-lg p-6 space-y-6",children:[y&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:y})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 after:content-['*'] after:ml-0.5 after:text-red-500",children:"Idea Title"}),e.jsx("input",{type:"text",id:"title",required:!0,placeholder:"Enter your idea title here",value:l.title,onChange:j=>d(v=>({...v,title:j.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 after:content-['*'] after:ml-0.5 after:text-red-500",children:"Idea Category"}),e.jsxs("select",{id:"category",required:!0,value:l.category,onChange:j=>d(v=>({...v,category:j.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",children:[e.jsx("option",{value:"",children:"Select a category"}),$s.map(j=>e.jsx("option",{value:j,children:j},j))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 after:content-['*'] after:ml-0.5 after:text-red-500",children:"Idea Description"}),e.jsx("textarea",{id:"description",required:!0,rows:6,placeholder:"Provide a detailed description of your idea",value:l.description,onChange:j=>d(v=>({...v,description:j.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Resource Links"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:x,onChange:j=>h(j.target.value),placeholder:"Link title",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"url",value:N,onChange:j=>f(j.target.value),placeholder:"https://example.com",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})}),e.jsx("button",{type:"button",onClick:I,disabled:!N.trim()||!x.trim(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:e.jsx(me,{className:"h-4 w-4"})})]}),l.resourceLinks.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Added Links:"}),e.jsx("div",{className:"space-y-2",children:l.resourceLinks.map(j=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-md p-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:j.title}),e.jsx("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-indigo-600 hover:text-indigo-500",children:j.url})]})]}),e.jsx("button",{type:"button",onClick:()=>S(j.id),className:"text-gray-400 hover:text-gray-500",children:e.jsx(le,{className:"h-4 w-4"})})]},j.id))})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contributors"}),e.jsxs("div",{className:"mt-1 space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",value:n,onChange:E,placeholder:"Search contributors by email",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"}),C&&e.jsx("div",{className:"absolute right-3 top-2",children:e.jsx(R,{className:"h-5 w-5 animate-spin text-gray-400"})}),u.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto max-h-60",children:u.map(j=>e.jsxs("button",{type:"button",onClick:()=>T(j),className:"w-full text-left px-4 py-2 text-sm text-gray-900 hover:bg-gray-100 flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j.full_name||"Unnamed User"}),e.jsx("p",{className:"text-gray-500",children:j.email})]})]},j.id))})]}),l.contributors.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Added Contributors:"}),e.jsx("div",{className:"space-y-2",children:l.contributors.map(j=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-md p-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:j.full_name||"Unnamed User"}),e.jsx("p",{className:"text-xs text-gray-500",children:j.email})]})]}),e.jsx("button",{type:"button",onClick:()=>p(j.id),className:"text-gray-400 hover:text-gray-500",children:e.jsx(le,{className:"h-4 w-4"})})]},j.id))})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>t(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o,className:_("inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white","bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",o&&"opacity-75 cursor-not-allowed"),children:o?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"animate-spin h-4 w-4 mr-2"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:["Submit Idea",e.jsx(us,{className:"ml-2 h-4 w-4"})]})})]})]})]})})}const Zs=["All Time","This Year","This Month","This Week"];function Xs(){const{data:s}=se(),{data:t}=je(),[a,o]=b.useState("All Time"),l=(r=>{if(!r)return[];const x=new Date;switch(a){case"This Week":const h=new Date(x.getTime()-6048e5);return r.filter(k=>new Date(k.created_at)>=h);case"This Month":const N=new Date(x.getFullYear(),x.getMonth(),1);return r.filter(k=>new Date(k.created_at)>=N);case"This Year":const f=new Date(x.getFullYear(),0,1);return r.filter(k=>new Date(k.created_at)>=f);default:return r}})(s),d={totalIdeas:l.length,totalUsers:(t==null?void 0:t.length)||0,activeUsers:(t==null?void 0:t.filter(r=>{var x,h;return((h=(x=r.ideas)==null?void 0:x[0])==null?void 0:h.count)>0}).length)||0,approvedIdeas:l.filter(r=>r.status==="approved").length,rejectedIdeas:l.filter(r=>r.status==="rejected").length,pendingIdeas:l.filter(r=>r.status==="pending").length,totalBeans:l.reduce((r,x)=>r+(x.beans_earned||0),0),totalComments:l.reduce((r,x)=>{var h;return r+(((h=x.comments)==null?void 0:h.length)||0)},0),totalVotes:l.reduce((r,x)=>{var h;return r+(((h=x.votes)==null?void 0:h.length)||0)},0),avgBeansPerIdea:l.length?Math.round(l.reduce((r,x)=>r+(x.beans_earned||0),0)/l.length*10)/10:0,avgCommentsPerIdea:l.length?Math.round(l.reduce((r,x)=>{var h;return r+(((h=x.comments)==null?void 0:h.length)||0)},0)/l.length*10)/10:0,avgVotesPerIdea:l.length?Math.round(l.reduce((r,x)=>{var h;return r+(((h=x.votes)==null?void 0:h.length)||0)},0)/l.length*10)/10:0},y=l.reduce((r,x)=>(r[x.category]=(r[x.category]||0)+1,r),{}),m=l.reduce((r,x)=>{const h=new Date(x.created_at).toLocaleString("default",{month:"long"});return r[h]=(r[h]||0)+1,r},{}),n={totalActiveUsers:(t==null?void 0:t.filter(r=>{var x,h;return((h=(x=r.ideas)==null?void 0:x[0])==null?void 0:h.count)>0}).length)||0,totalContributors:new Set(l.flatMap(r=>{var x;return((x=r.contributors)==null?void 0:x.map(h=>h.user_id))||[]})).size,mostActiveUsers:(t==null?void 0:t.filter(r=>{var x,h;return((h=(x=r.ideas)==null?void 0:x[0])==null?void 0:h.count)>0}).sort((r,x)=>{var h,N,f,k;return(((N=(h=x.ideas)==null?void 0:h[0])==null?void 0:N.count)||0)-(((k=(f=r.ideas)==null?void 0:f[0])==null?void 0:k.count)||0)}).slice(0,5))||[]},c=(r,x)=>{const h=r.map(k=>Object.values(k).map(E=>typeof E=="string"&&E.includes(",")?`"${E}"`:E).join(",")).join(`
`),N=new Blob([h],{type:"text/csv;charset=utf-8;"}),f=document.createElement("a");if(f.download!==void 0){const k=URL.createObjectURL(N);f.setAttribute("href",k),f.setAttribute("download",x),f.style.visibility="hidden",document.body.appendChild(f),f.click(),document.body.removeChild(f)}},u=()=>{if(!l)return;const r=[`Title,Category,Status,Beans,Comments,Votes,Created At
`],x=l.map(h=>{var N,f;return{title:h.title,category:h.category,status:h.status,beans:h.beans_earned||0,comments:((N=h.comments)==null?void 0:N.length)||0,votes:((f=h.votes)==null?void 0:f.length)||0,created_at:new Date(h.created_at).toLocaleDateString()}});c([...r,...x],"ideas-data.csv")},w=()=>{const r=[`Category,Count
`],x=Object.entries(y).map(([h,N])=>({category:h,count:N}));c([...r,...x],"category-stats.csv")},C=()=>{const r=[`Month,Submissions
`],x=Object.entries(m).map(([h,N])=>({month:h,count:N}));c([...r,...x],"monthly-stats.csv")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"inline-flex rounded-md shadow-sm",children:Zs.map(r=>e.jsx("button",{onClick:()=>o(r),className:_("relative inline-flex items-center px-4 py-2 border text-sm font-medium",a===r?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"border-gray-300 bg-white text-gray-500 hover:bg-gray-50","first:rounded-l-md last:rounded-r-md"),children:r},r))})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Ideas"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:d.totalIdeas})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(K,{className:"h-6 w-6 text-blue-600"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-green-600",children:[e.jsx("span",{className:"font-medium",children:d.approvedIdeas})," approved"]}),e.jsxs("div",{className:"text-yellow-600",children:[e.jsx("span",{className:"font-medium",children:d.pendingIdeas})," pending"]}),e.jsxs("div",{className:"text-red-600",children:[e.jsx("span",{className:"font-medium",children:d.rejectedIdeas})," rejected"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"User Engagement"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:d.totalUsers})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(W,{className:"h-6 w-6 text-green-600"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[n.totalActiveUsers," active users (",Math.round(n.totalActiveUsers/d.totalUsers*100),"%)"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Beans"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:d.totalBeans})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(P,{className:"h-6 w-6 text-yellow-600"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[d.avgBeansPerIdea," beans per idea"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Engagement Rate"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Math.round((d.totalComments+d.totalVotes)/d.totalIdeas*10)/10})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(xe,{className:"h-6 w-6 text-purple-600"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-sm",children:[e.jsxs("span",{children:[d.totalComments," comments"]}),e.jsxs("span",{children:[d.totalVotes," votes"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(hs,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Category Distribution"]}),e.jsxs("button",{onClick:w,className:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Download CSV"]})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(y).map(([r,x])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(he,{className:"h-4 w-4 mr-2 text-indigo-600"}),r]}),e.jsxs("span",{className:"font-medium",children:[x," ideas"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${x/d.totalIdeas*100}%`}})})]},r))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(xe,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Monthly Submissions"]}),e.jsxs("button",{onClick:C,className:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"Download CSV"]})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(m).map(([r,x])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(gs,{className:"h-4 w-4 mr-2 text-indigo-600"}),r]}),e.jsxs("span",{className:"font-medium",children:[x," ideas"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${x/Math.max(...Object.values(m))*100}%`}})})]},r))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[e.jsx(Fe,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Top Contributors"]})}),e.jsx("div",{className:"space-y-4",children:n.mostActiveUsers.map((r,x)=>{var h,N,f,k;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx(W,{className:"h-5 w-5 text-indigo-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.full_name||"Anonymous"}),e.jsx("p",{className:"text-sm text-gray-500",children:r.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),((N=(h=r.ideas)==null?void 0:h[0])==null?void 0:N.count)||0," ideas"]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),((k=(f=r.comments)==null?void 0:f[0])==null?void 0:k.count)||0," comments"]})]})]},r.id)})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:u,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Export Full Data"]})})]})}function Gs(){const{data:s,isLoading:t}=je(),{mutate:a,isLoading:o}=Ke(),[g,l]=b.useState(null),[d,y]=b.useState({full_name:"",department:""}),m=u=>{l(u.id),y({full_name:u.full_name||"",department:u.department||""})},n=async u=>{try{await a({id:u,...d}),l(null)}catch(w){console.error("Error updating user:",w)}},c=()=>{l(null),y({full_name:"",department:""})};return t?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"})}):e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"User Management"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ideas"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comments"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s==null?void 0:s.map(u=>{var w,C,r,x;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g===u.id?e.jsx("input",{type:"text",value:d.full_name,onChange:h=>y({...d,full_name:h.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}):e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx(B,{className:"h-6 w-6 text-indigo-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:u.full_name||"Unnamed User"}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),u.email]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g===u.id?e.jsx("input",{type:"text",value:d.department,onChange:h=>y({...d,department:h.target.value}),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}):e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(ps,{className:"h-4 w-4 mr-1 text-gray-400"}),u.department||"Not specified"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((C=(w=u.ideas)==null?void 0:w[0])==null?void 0:C.count)||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((x=(r=u.comments)==null?void 0:r[0])==null?void 0:x.count)||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:g===u.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n(u.id),disabled:o,className:_("text-green-600 hover:text-green-900",o&&"opacity-50 cursor-not-allowed"),children:e.jsx(Ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:c,className:"text-gray-600 hover:text-gray-900",children:e.jsx(le,{className:"h-4 w-4"})})]}):e.jsx("button",{onClick:()=>m(u),className:"text-indigo-600 hover:text-indigo-900",children:e.jsx(fs,{className:"h-4 w-4"})})})]},u.id)})})]})})]})})}function et(s){return ee({queryKey:["bean-awards",s],queryFn:async()=>{if(!s)return[];const{data:t,error:a}=await A.from("bean_awards").select(`
          *,
          awarded_by:profiles(*)
        `).eq("idea_id",s).order("created_at",{ascending:!1});if(a)throw a;return t},enabled:!!s})}function st(){const s=O();return Q({mutationFn:async t=>{const{data:a,error:o}=await A.from("bean_awards").insert(t).select().single();if(o)throw o;return a},onSuccess:(t,a)=>{s.invalidateQueries({queryKey:["bean-awards",a.idea_id]}),s.invalidateQueries({queryKey:["ideas"]})}})}function tt(){var S,D;const{user:s}=M(),{data:t,isLoading:a}=se(),{mutate:o}=Fs(),{mutate:g}=st(),[l,d]=b.useState(null),[y,m]=b.useState(0),[n,c]=b.useState(""),[u,w]=b.useState(!1),{data:C}=et(l==null?void 0:l.id),[r,x]=b.useState(""),[h,N]=b.useState(null),[f,k]=b.useState(null),E=async(i,j,v)=>{if(s){if(!v.trim()){alert("Please provide a note for the status change.");return}await o({id:i,updates:{status:j,feedback:v,feedback_by:s.id,feedback_at:new Date().toISOString()},editorId:s.id}),N(null),x("")}},T=async(i,j)=>{s&&await o({id:i,updates:{hidden:j},editorId:s.id})},p=async()=>{if(!(!s||!l)){if(y<=0){alert("Please enter a valid number of beans.");return}if(!n.trim()){alert("Please provide a note for the beans award.");return}await g({idea_id:l.id,awarded_by:s.id,beans_amount:y,note:n.trim()}),m(0),c(""),d(null)}},I=i=>{k(i)};return a?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Idea Management"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Beans"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t==null?void 0:t.map(i=>e.jsxs("tr",{className:_(i.hidden&&"bg-gray-50"),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx("button",{onClick:()=>I(i),className:"text-sm font-medium text-gray-900 hover:text-indigo-600",children:i.title})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:i.category})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:_("px-2 inline-flex text-xs leading-5 font-semibold rounded-full",i.status==="approved"&&"bg-green-100 text-green-800",i.status==="rejected"&&"bg-red-100 text-red-800",i.status==="pending"&&"bg-yellow-100 text-yellow-800"),children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-500",children:i.beans_earned||0})}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium space-x-2",children:[i.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N({ideaId:i.id,status:"approved"}),className:"text-green-600 hover:text-green-900",title:"Approve Idea",children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>N({ideaId:i.id,status:"rejected"}),className:"text-red-600 hover:text-red-900",title:"Reject Idea",children:e.jsx(De,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:()=>d(i),className:"text-yellow-600 hover:text-yellow-900",title:"Award Beans",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>T(i.id,!i.hidden),className:_("hover:text-gray-900",i.hidden?"text-red-600":"text-gray-600"),title:i.hidden?"Show Idea":"Hide Idea",children:i.hidden?e.jsx(js,{className:"h-4 w-4"}):e.jsx(ys,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>I(i),className:"text-indigo-600 hover:text-indigo-900",title:"View Details",children:e.jsx(bs,{className:"h-4 w-4"})})]})]},i.id))})]})})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[h.status==="approved"?"Approve":"Reject"," Idea"]}),e.jsx("button",{onClick:()=>{N(null),x("")},className:"text-gray-400 hover:text-gray-500",children:e.jsx(X,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Feedback Note (Required)"}),e.jsx("textarea",{value:r,onChange:i=>x(i.target.value),rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:`Explain why you're ${h.status==="approved"?"approving":"rejecting"} this idea...`})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{N(null),x("")},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>E(h.ideaId,h.status,r),className:_("inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white",h.status==="approved"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"),children:h.status==="approved"?e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Approve"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Reject"]})})]})]})]})})}),l&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Award Beans"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:l.title})]}),e.jsx("button",{onClick:()=>{d(null),w(!1)},className:"text-gray-400 hover:text-gray-500",children:e.jsx(X,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>w(!u),className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(Ns,{className:"h-4 w-4 mr-1"}),u?"Hide History":"Show History"]})}),u&&C&&C.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Award History"}),e.jsx("div",{className:"space-y-3",children:C.map(i=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:i.awarded_by.full_name||"Anonymous"}),e.jsx("span",{children:new Date(i.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center text-yellow-600 mt-1",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),i.beans_amount," beans"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.note})]},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Number of Beans"}),e.jsx("input",{type:"number",min:"0",value:y,onChange:i=>m(parseInt(i.target.value)||0),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Note"}),e.jsx("textarea",{value:n,onChange:i=>c(i.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Explain why you're awarding these beans..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{d(null),w(!1)},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Award Beans"]})]})]})]})})}),f&&e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:f.title}),e.jsx("button",{onClick:()=>k(null),className:"text-gray-400 hover:text-gray-500",children:e.jsx(X,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-gray-600",children:f.description})]}),f.feedback&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Feedback"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-6 w-6 rounded-full bg-indigo-100 flex items-center justify-center mr-2",children:e.jsx(B,{className:"h-3 w-3 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:((S=f.feedback_by)==null?void 0:S.full_name)||"Anonymous Admin"}),f.feedback_at&&e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["on ",new Date(f.feedback_at).toLocaleDateString()]})]})]})}),e.jsx("p",{className:"text-gray-600",children:f.feedback})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Details"}),e.jsxs("dl",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 rounded-lg",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Category"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:f.category})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 rounded-lg",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:f.status})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 rounded-lg",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Submitted By"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:((D=f.author)==null?void 0:D.full_name)||"Anonymous"})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 rounded-lg",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Submission Date"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(f.created_at).toLocaleDateString()})]})]})]})]})]})})})]})}function at(s){const t=[];let a=[],o="",g=!1;for(let l=0;l<s.length;l++){const d=s[l],y=s[l+1];d==='"'?g&&y==='"'?(o+='"',l++):g=!g:d===","&&!g?(a.push(o.trim()),o=""):d===`
`&&!g?(a.push(o.trim()),a.some(m=>m)&&t.push(a),a=[],o=""):o+=d}return(o||a.length>0)&&(a.push(o.trim()),a.some(l=>l)&&t.push(a)),t}function rt(){const{user:s}=M(),{mutate:t}=We(),[a,o]=b.useState(!1),[g,l]=b.useState([]),[d,y]=b.useState(null),m=b.useRef(null),n=()=>{const w=["title,description,category,status,author_email,contributor_emails,resource_links",'"Example Idea","This is a description with, commas","Lammas - Accelerator & Native Apps","pending","author@kipi.ai","contributor1@kipi.ai,contributor2@kipi.ai","[{""title"":""Documentation"",""url"":""https://example.com""}]"'].join(`
`),C=new Blob([w],{type:"text/csv"}),r=URL.createObjectURL(C),x=document.createElement("a");x.href=r,x.download="ideas_import_template.csv",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(r)},c=async(w,C)=>{const r=[];try{const[x,h,N,f,k,E,T]=w;if(x!=null&&x.trim()||r.push("Title is required"),h!=null&&h.trim()||r.push("Description is required"),N!=null&&N.trim()||r.push("Category is required"),k!=null&&k.trim()||r.push("Author email is required"),["Lammas - Accelerator & Native Apps","Technology COE - Reusable Assets/Enablers","Delivery - Process Improvement","Industry Solutions - Domain Expertise & Business Use Cases","Data Science","Learning & Development","Sales & Marketing","Operations, HR, CSM, ESM, etc."].includes(N==null?void 0:N.trim())||r.push("Invalid category"),f&&!["pending","approved","rejected"].includes(f.trim())&&r.push("Invalid status"),k!=null&&k.trim()){const{data:S,error:D}=await A.from("profiles").select("id").eq("email",k.trim()).maybeSingle();(D||!S)&&r.push(`Author email ${k} not found`)}if(E!=null&&E.trim()){const S=E.split(",").map(D=>D.trim()).filter(Boolean);if(S.length>0){const{data:D,error:i}=await A.from("profiles").select("id, email").in("email",S);if(i)r.push("Error validating contributor emails");else{const j=new Set(D==null?void 0:D.map(L=>L.email)),v=S.filter(L=>!j.has(L));v.length>0&&r.push(`Contributors not found: ${v.join(", ")}`)}}}if(T!=null&&T.trim())try{const S=JSON.parse(T);Array.isArray(S)?S.every(i=>typeof i=="object"&&typeof i.title=="string"&&typeof i.url=="string"&&i.url.startsWith("http"))||r.push("Invalid resource links format"):r.push("Resource links must be an array")}catch{r.push("Invalid resource links JSON")}}catch(x){console.error("Validation error:",x),r.push("Failed to validate row")}return r},u=async w=>{var r;const C=(r=w.target.files)==null?void 0:r[0];if(!(!C||!s)){o(!0),l([]),y(null);try{const x=await C.text(),h=at(x);if(h.length<2)throw new Error("File must contain a header row and at least one data row");const N=h[0],f=["title","description","category","status","author_email","contributor_emails","resource_links"];if(N.length!==f.length||!f.every((I,S)=>N[S].toLowerCase().trim()===I))throw new Error("Invalid CSV format. Please use the template provided.");const k=h.slice(1),E=k.map((I,S)=>c(I,S)),p=(await Promise.all(E)).map((I,S)=>I.length>0?{row:S+1,errors:I}:null).filter(I=>I!==null);if(l(p),p.length===0){let I=0,S=0;for(const D of k)try{const[i,j,v,L,U,V,te]=D,{data:Y}=await A.from("profiles").select("id").eq("email",U.trim()).single();if(!Y)throw new Error("Author not found");await t({title:i.trim(),description:j.trim(),category:v.trim(),status:L.trim()||"pending",author_id:Y.id,resource_links:te?JSON.parse(te):[]},{onSuccess:async $e=>{if(V!=null&&V.trim()){const ye=V.split(",").map($=>$.trim()).filter(Boolean);if(ye.length>0){const{data:$}=await A.from("profiles").select("id").in("email",ye);$!=null&&$.length&&await Promise.all($.map(Je=>A.from("idea_contributors").insert({idea_id:$e.id,user_id:Je.id})))}}}}),I++}catch(i){console.error("Error importing idea:",i),S++}y({total:k.length,success:I,failed:S})}}catch(x){console.error("Error processing file:",x),l([{row:0,errors:[x.message||"Failed to process file. Please check the format."]}])}finally{o(!1),m.current&&(m.current.value="")}}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-2",children:"Import Ideas"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Import ideas from a CSV file. Download the template below to ensure correct formatting."}),e.jsxs("div",{className:"mt-4 bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"CSV Format Instructions:"}),e.jsxs("ul",{className:"list-disc pl-5 text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"Basic fields: title, description, category, status, author_email"}),e.jsx("li",{children:"contributor_emails: Comma-separated list of contributor email addresses"}),e.jsx("li",{children:"resource_links: JSON array of objects with title and url properties"}),e.jsxs("li",{children:["Example resource links: [",'"title":"Documentation","url":"https://example.com"',"]"]}),e.jsx("li",{children:"Use quotes for values containing commas"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("button",{onClick:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Download Template"]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV File"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(Pe,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex text-sm text-gray-600",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500",children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"file-upload",ref:m,type:"file",className:"sr-only",accept:".csv",onChange:u,disabled:a})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"CSV files only"})]})})]}),g.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx(Be,{className:"h-5 w-5 text-red-400 mr-2"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Validation errors found"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:g.map((w,C)=>e.jsxs("li",{children:[w.row===0?"File error":`Row ${w.row}`,": ",w.errors.join(", ")]},C))})})]})]})}),a&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 rounded-md",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"h-5 w-5 text-blue-400 animate-spin mr-2"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Importing ideas... Please wait."})]})}),d&&e.jsx("div",{className:_("mt-4 p-4 rounded-md",d.failed===0?"bg-green-50":"bg-yellow-50"),children:e.jsxs("div",{className:"flex",children:[d.failed===0?e.jsx(fe,{className:"h-5 w-5 text-green-400 mr-2"}):e.jsx(X,{className:"h-5 w-5 text-yellow-400 mr-2"}),e.jsxs("div",{children:[e.jsx("h3",{className:_("text-sm font-medium",d.failed===0?"text-green-800":"text-yellow-800"),children:"Import completed"}),e.jsx("div",{className:"mt-2 text-sm",children:e.jsxs("p",{className:d.failed===0?"text-green-700":"text-yellow-700",children:["Successfully imported ",d.success," of ",d.total," ideas.",d.failed>0&&` Failed to import ${d.failed} ideas.`]})})]})]})})]})]})})}const _e=[{id:"ideas",name:"Idea Management",icon:vs},{id:"analytics",name:"Analytics",icon:ws},{id:"users",name:"User Management",icon:W},{id:"import",name:"Import Ideas",icon:Pe}];function it(){const[s,t]=b.useState("ideas");return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"sm:hidden",children:e.jsx("select",{value:s,onChange:a=>t(a.target.value),className:"block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm",children:_e.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))})}),e.jsx("div",{className:"hidden sm:block",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:_e.map(a=>{const o=a.icon;return e.jsxs("button",{onClick:()=>t(a.id),className:_(s===a.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700","group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm"),children:[e.jsx(o,{className:_("mr-2 h-5 w-5",s===a.id?"text-indigo-500":"text-gray-400 group-hover:text-gray-500")}),a.name]},a.id)})})})})]}),e.jsxs("div",{children:[s==="analytics"&&e.jsx(Xs,{}),s==="users"&&e.jsx(Gs,{}),s==="ideas"&&e.jsx(tt,{}),s==="import"&&e.jsx(rt,{})]})]})})}const nt=[{id:"innovator",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=innovator&backgroundColor=4f46e5",label:"Innovator"},{id:"creator",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=creator&backgroundColor=3b82f6",label:"Creator"},{id:"thinker",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=thinker&backgroundColor=22c55e",label:"Thinker"},{id:"visionary",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=visionary&backgroundColor=a855f7",label:"Visionary"},{id:"explorer",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=explorer&backgroundColor=ec4899",label:"Explorer"},{id:"builder",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=builder&backgroundColor=eab308",label:"Builder"},{id:"scientist",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=scientist&backgroundColor=ef4444",label:"Scientist"},{id:"artist",url:"https://api.dicebear.com/7.x/fun-emoji/svg?seed=artist&backgroundColor=f97316",label:"Artist"}];function lt({selectedAvatar:s,onSelect:t}){return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:nt.map(a=>e.jsxs("button",{onClick:()=>t(a.url),className:_("relative aspect-square rounded-lg overflow-hidden group transition-all duration-300 hover:scale-105","border-2",s===a.url?"border-indigo-500 ring-2 ring-indigo-500 ring-offset-2":"border-gray-200 hover:border-indigo-200"),children:[e.jsx("img",{src:a.url,alt:a.label,className:"w-full h-full object-cover bg-white"}),e.jsx("div",{className:_("absolute inset-0 flex items-center justify-center bg-black/50 transition-opacity",s===a.url?"opacity-0":"opacity-0 group-hover:opacity-100"),children:e.jsx("p",{className:"text-white text-sm font-medium",children:a.label})}),s===a.url&&e.jsx("div",{className:"absolute top-2 right-2 bg-indigo-500 rounded-full p-1",children:e.jsx(Le,{className:"h-4 w-4 text-white"})})]},a.id))})}function ot(){const s=ce(),{user:t}=M(),{data:a,isLoading:o}=Ve((t==null?void 0:t.id)||""),{mutate:g,isLoading:l}=Ke(),[d,y]=b.useState({full_name:"",department:"",avatar_url:""}),[m,n]=b.useState(null),[c,u]=b.useState(!1);b.useEffect(()=>{a&&y({full_name:a.full_name||"",department:a.department||"",avatar_url:a.avatar_url||""})},[a]);const w=async C=>{if(C.preventDefault(),!!t)try{n(null),u(!1),await g({id:t.id,...d}),u(!0)}catch(r){console.error("Error updating profile:",r),n("Failed to update profile. Please try again.")}};return o?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading profile..."})]})}):e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white shadow-lg rounded-lg overflow-hidden",children:e.jsxs("div",{className:"px-6 py-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-8",children:[e.jsx("div",{className:"h-20 w-20 rounded-full overflow-hidden bg-indigo-100 flex items-center justify-center",children:d.avatar_url?e.jsx("img",{src:d.avatar_url,alt:"Profile Avatar",className:"w-full h-full object-cover"}):e.jsx(B,{className:"h-12 w-12 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile Settings"}),e.jsxs("p",{className:"text-gray-600 flex items-center mt-1",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),t==null?void 0:t.email]})]})]}),m&&e.jsx("div",{className:"mb-4 p-4 rounded-md bg-red-50",children:e.jsx("p",{className:"text-sm text-red-700",children:m})}),c&&e.jsx("div",{className:"mb-4 p-4 rounded-md bg-green-50",children:e.jsx("p",{className:"text-sm text-green-700",children:"Profile updated successfully!"})}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Choose Avatar"}),e.jsx(lt,{selectedAvatar:d.avatar_url,onSelect:C=>y(r=>({...r,avatar_url:C}))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"text",id:"full_name",value:d.full_name,onChange:C=>y(r=>({...r,full_name:C.target.value})),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter your full name"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700",children:"Department"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{type:"text",id:"department",value:d.department,onChange:C=>y(r=>({...r,department:C.target.value})),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter your department"})})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>s(-1),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:_("inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white","bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",l&&"opacity-75 cursor-not-allowed"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"animate-spin h-4 w-4 mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})]})})})})}const Ie=[{category:"General Questions",questions:[{question:"What is Kipi Innovate?",answer:"Kipi Innovate is a platform designed to foster innovation within our organization. It allows employees to submit ideas, collaborate with others, and earn recognition for their contributions to organizational improvement."},{question:"Why should I use Kipi Innovate?",answer:"Using Kipi Innovate gives you the opportunity to share your innovative ideas, contribute to organizational growth, collaborate with colleagues, and earn rewards through our beans system."}]},{category:"Idea Submission and Review",questions:[{question:"How do I submit an idea?",answer:'To submit an idea, navigate to the "My Ideas" section and click on the "Submit New Idea" button. Fill out the required information including title, description, and category, then submit for review.'},{question:"What happens after I submit an idea?",answer:"After submission, your idea goes through a review process by our evaluation team. You'll receive notifications about status changes and any feedback provided."},{question:"What criteria are used to evaluate ideas?",answer:"Ideas are evaluated based on innovation, feasibility, potential impact, alignment with organizational goals, and resource requirements."}]},{category:"Recognition and Rewards",questions:[{question:"How are contributions recognized?",answer:"Contributors earn beans for approved ideas and additional engagement. Top contributors are featured on the platform's leaderboard and receive special recognition."},{question:"What rewards can I redeem with Beans?",answer:"Beans can be redeemed for various rewards including company merchandise, extra time off, learning resources, and other special perks."}]},{category:"Implementation and Impact",questions:[{question:"How is an idea implemented after approval?",answer:"Approved ideas are assigned to relevant teams for implementation. The original contributor is often involved in the implementation process and can track progress."},{question:"How is the impact of an implemented idea assessed?",answer:"We track various metrics depending on the idea type, including cost savings, efficiency improvements, user satisfaction, and other relevant KPIs."}]},{category:"Technical Support",questions:[{question:"Who do I contact if I face issues on the platform?",answer:"For technical support, please reach out to our support team through the Contact page or email support@kipi-innovate.com."},{question:"Can I edit my idea after submission?",answer:`Yes, you can edit your idea while it's in "Pending" status. Once the review process begins, you'll need to contact support for any necessary changes.`}]}];function ct(){const[s,t]=b.useState([Ie[0].category]),[a,o]=b.useState([]),g=d=>{t(y=>y.includes(d)?y.filter(m=>m!==d):[...y,d])},l=d=>{o(y=>y.includes(d)?y.filter(m=>m!==d):[...y,d])};return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Frequently Asked Questions"}),e.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Find answers to common questions about using Kipi Innovate"})]}),e.jsx("div",{className:"space-y-6",children:Ie.map(d=>e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsxs("button",{className:"w-full px-6 py-4 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",onClick:()=>g(d.category),children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:d.category}),s.includes(d.category)?e.jsx(we,{className:"h-5 w-5 text-gray-500"}):e.jsx(Ce,{className:"h-5 w-5 text-gray-500"})]}),s.includes(d.category)&&e.jsx("div",{className:"divide-y divide-gray-200",children:d.questions.map(y=>e.jsxs("div",{className:"px-6",children:[e.jsxs("button",{className:"w-full py-4 flex items-center justify-between text-left",onClick:()=>l(y.question),children:[e.jsx("h3",{className:"text-base font-medium text-gray-900",children:y.question}),a.includes(y.question)?e.jsx(we,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}):e.jsx(Ce,{className:"h-5 w-5 text-gray-500 flex-shrink-0"})]}),a.includes(y.question)&&e.jsx("div",{className:"pb-4",children:e.jsx("p",{className:"text-gray-600",children:y.answer})})]},y.question))})]},d.category))})]})})}function dt(){return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Contact Us"}),e.jsx("p",{className:"mt-4 text-lg text-gray-600",children:"Get in touch with the TSC team for any questions or support"})]}),e.jsx("div",{className:"card p-8",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx(H,{className:"h-12 w-12 text-indigo-600 mx-auto"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Please reach out to the TSC team for more details or write to us at:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:"mailto:dharman.d.joshi@kipi.ai",className:"flex items-center justify-center text-indigo-600 hover:text-indigo-700 transition-colors",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),"dharman.d.joshi@kipi.ai"]}),e.jsxs("a",{href:"mailto:veeranjaneya.a.tiruveedhula@kipi.ai",className:"flex items-center justify-center text-indigo-600 hover:text-indigo-700 transition-colors",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),"veeranjaneya.a.tiruveedhula@kipi.ai"]})]})]})})]})})}function mt(){const[s,t]=b.useState(""),[a,o]=b.useState(""),[g,l]=b.useState(""),[d,y]=b.useState(!1),m=ce(),{signIn:n}=M(),c=async u=>{u.preventDefault();try{l(""),y(!0),await n(s,a),m("/")}catch(w){l("Invalid email or password"),console.error(w)}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 via-white to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"h-12 w-12 text-indigo-600 animate-pulse"}),e.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-yellow-400 rounded-full animate-ping"})]})}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Sign in to continue to Kipi Innovate"})]}),e.jsx("div",{className:"mt-8 bg-white py-8 px-4 shadow-2xl rounded-lg sm:px-10",children:e.jsxs("form",{className:"space-y-6",onSubmit:c,children:[g&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Be,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-red-800",children:g})})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(z,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:u=>t(u.target.value),className:"appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter your email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Cs,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a,onChange:u=>o(u.target.value),className:"appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter your password"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:d,className:_("w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white","bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500","transition-all duration-200 transform hover:scale-[1.02]",d&&"opacity-75 cursor-not-allowed"),children:d?e.jsxs("div",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Sign in"})}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",e.jsx(q,{to:"/register",className:"font-medium text-indigo-600 hover:text-indigo-500 transition-colors",children:"Contact TSC team"})]})})]})})]})})}function xt(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 via-white to-blue-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"h-12 w-12 text-indigo-600 animate-pulse"}),e.jsx("div",{className:"absolute -top-1 -right-1 h-3 w-3 bg-yellow-400 rounded-full animate-ping"})]})}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-4",children:"Join Kipi Innovate"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Contact the TSC team to get your account set up"})]}),e.jsx("div",{className:"bg-white py-8 px-4 shadow-2xl rounded-lg sm:px-10",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-gray-700",children:"Please reach out to one of our TSC team members:"}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("a",{href:"mailto:dharman.d.joshi@kipi.ai",className:"flex items-center justify-center text-indigo-600 hover:text-indigo-700 transition-colors group",children:[e.jsx(z,{className:"h-5 w-5 mr-2 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"border-b border-indigo-200 group-hover:border-indigo-600",children:"dharman.d.joshi@kipi.ai"})]}),e.jsxs("a",{href:"mailto:veeranjaneya.a.tiruveedhula@kipi.ai",className:"flex items-center justify-center text-indigo-600 hover:text-indigo-700 transition-colors group",children:[e.jsx(z,{className:"h-5 w-5 mr-2 group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"border-b border-indigo-200 group-hover:border-indigo-600",children:"veeranjaneya.a.tiruveedhula@kipi.ai"})]})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",e.jsx(q,{to:"/login",className:"font-medium text-indigo-600 hover:text-indigo-500 transition-colors",children:"Sign in"})]})})]})})]})})}const ut=["All Time","This Year","This Month","This Week"];function ht(){const{data:s}=se(),{data:t}=je(),[a,o]=b.useState("All Time"),l=(n=>{if(!n)return[];const c=new Date;switch(a){case"This Week":const u=new Date(c.getTime()-6048e5);return n.filter(r=>new Date(r.created_at)>=u);case"This Month":const w=new Date(c.getFullYear(),c.getMonth(),1);return n.filter(r=>new Date(r.created_at)>=w);case"This Year":const C=new Date(c.getFullYear(),0,1);return n.filter(r=>new Date(r.created_at)>=C);default:return n}})(s||[]),d=(t==null?void 0:t.map(n=>{const c=l.filter(x=>x.author_id===n.id),u=c.reduce((x,h)=>x+(h.beans_earned||0),0),w=c.reduce((x,h)=>{var N;return x+(((N=h.votes)==null?void 0:N.length)||0)},0),C=c.reduce((x,h)=>{var N;return x+(((N=h.comments)==null?void 0:N.length)||0)},0),r=c.filter(x=>x.status==="approved").length;return{id:n.id,name:n.full_name||"Anonymous",email:n.email,department:n.department,ideasCount:c.length,approvedIdeas:r,totalBeans:u,totalVotes:w,totalComments:C,score:u*3+r*5+w+C}}).sort((n,c)=>c.score-n.score))||[],y=Object.entries(l.reduce((n,c)=>(n[c.category]||(n[c.category]=[]),n[c.category].push(c),n),{})).map(([n,c])=>{const u=t==null?void 0:t.find(w=>{var C;return w.id===c.reduce((r,x)=>{const h=c.filter(f=>f.author_id===x.author_id).length,N=c.filter(f=>f.author_id===r).length;return h>N?x.author_id:r},(C=c[0])==null?void 0:C.author_id)});return{category:n,ideasCount:c.length,topContributor:(u==null?void 0:u.full_name)||"Anonymous",topContributorEmail:u==null?void 0:u.email,totalBeans:c.reduce((w,C)=>w+(C.beans_earned||0),0)}}).sort((n,c)=>c.ideasCount-n.ideasCount),m=n=>{switch(n){case 0:return e.jsx(Ss,{className:"h-6 w-6 text-yellow-500"});case 1:return e.jsx(pe,{className:"h-6 w-6 text-gray-400"});case 2:return e.jsx(P,{className:"h-6 w-6 text-amber-600"});default:return e.jsx(Fe,{className:"h-6 w-6 text-indigo-400"})}};return e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx(ks,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Innovation Champions"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Celebrating our top contributors and their impactful ideas"})]}),e.jsx("div",{className:"flex justify-end mb-8",children:e.jsx("div",{className:"inline-flex rounded-md shadow-sm",children:ut.map(n=>e.jsx("button",{onClick:()=>o(n),className:_("relative inline-flex items-center px-4 py-2 border text-sm font-medium",a===n?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"border-gray-300 bg-white text-gray-500 hover:bg-gray-50","first:rounded-l-md last:rounded-r-md"),children:n},n))})}),e.jsxs("div",{className:"mb-12",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center",children:[e.jsx(W,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Top Contributors"]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:d.slice(0,9).map((n,c)=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 transform transition-all duration-300 hover:scale-105",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:m(c)}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n.name}),e.jsx("p",{className:"text-sm text-gray-500",children:n.department||"No Department"})]})]}),e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:["#",c+1]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-1 text-blue-500"}),e.jsxs("span",{children:[n.approvedIdeas," approved ideas"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-4 w-4 mr-1 text-yellow-500"}),e.jsxs("span",{children:[n.totalBeans," beans"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-4 w-4 mr-1 text-green-500"}),e.jsxs("span",{children:[n.totalVotes," votes"]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-4 w-4 mr-1 text-purple-500"}),e.jsxs("span",{children:[n.totalComments," comments"]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Total Score"}),e.jsxs("span",{className:"font-semibold text-indigo-600",children:[n.score," points"]})]})})]},n.id))})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center",children:[e.jsx(he,{className:"h-6 w-6 mr-2 text-indigo-600"}),"Category Champions"]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Top Contributor"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ideas"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Beans Earned"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((n,c)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ge,{className:"h-5 w-5 text-indigo-600 mr-2"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.category})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[c<3&&e.jsx("div",{className:"flex-shrink-0 mr-2",children:m(c)}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.topContributor}),e.jsx("div",{className:"text-sm text-gray-500",children:n.topContributorEmail})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[n.ideasCount," ideas"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-900",children:[e.jsx(P,{className:"h-4 w-4 mr-1 text-yellow-500"}),n.totalBeans]})})]},n.category))})]})})]})]})})}const gt=new Ze({defaultOptions:{queries:{staleTime:1e3*60*5,cacheTime:1e3*60*30,refetchOnWindowFocus:!1,retry:1}}});function Ye(){return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(R,{className:"h-8 w-8 animate-spin text-indigo-600"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading..."})]})})}function Z({children:s,adminOnly:t=!1}){var l;const{user:a,loading:o}=M(),g=(l=a==null?void 0:a.email)==null?void 0:l.endsWith("@kipi.ai");return o?e.jsx(Ye,{}):!a||t&&!g?e.jsx(ue,{to:"/login",replace:!0}):e.jsx(e.Fragment,{children:s})}function Ae({children:s}){const{user:t,loading:a}=M();return a?e.jsx(Ye,{}):t?e.jsx(ue,{to:"/",replace:!0}):e.jsx(e.Fragment,{children:s})}function pt(){var a;const{user:s}=M(),t=(a=s==null?void 0:s.email)==null?void 0:a.endsWith("@kipi.ai");return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(qs,{showAdminLink:t}),e.jsx("main",{className:"flex-grow bg-gray-50",children:e.jsxs(rs,{children:[e.jsx(F,{path:"/",element:e.jsx(Bs,{})}),e.jsx(F,{path:"/faq",element:e.jsx(ct,{})}),e.jsx(F,{path:"/contact",element:e.jsx(dt,{})}),e.jsx(F,{path:"/leaderboard",element:e.jsx(Z,{children:e.jsx(ht,{})})}),e.jsx(F,{path:"/browse",element:e.jsx(Z,{children:e.jsx(Ws,{})})}),e.jsx(F,{path:"/my-ideas",element:e.jsx(Z,{children:e.jsx(Ys,{})})}),e.jsx(F,{path:"/submit",element:e.jsx(Z,{children:e.jsx(Js,{})})}),e.jsx(F,{path:"/profile",element:e.jsx(Z,{children:e.jsx(ot,{})})}),e.jsx(F,{path:"/admin",element:e.jsx(Z,{adminOnly:!0,children:e.jsx(it,{})})}),e.jsx(F,{path:"/login",element:e.jsx(Ae,{children:e.jsx(mt,{})})}),e.jsx(F,{path:"/register",element:e.jsx(Ae,{children:e.jsx(xt,{})})}),e.jsx(F,{path:"*",element:e.jsx(ue,{to:"/",replace:!0})})]})}),e.jsx(Ts,{})]})}function ft(){return e.jsxs(Xe,{client:gt,children:[e.jsx(As,{children:e.jsx(as,{children:e.jsx(pt,{})})}),e.jsx(Ge,{initialIsOpen:!1})]})}Oe(document.getElementById("root")).render(e.jsx(b.StrictMode,{children:e.jsx(ft,{})}));
//# sourceMappingURL=index-BG1ZP1wc.js.map
